{% extends "base_neon.html" %}
{% load static %}

{% block title %}Вход / Регистрация{% endblock %}

{% block extra_head %}
  <link rel="stylesheet" href="{% static 'authentication/css/auth_landing.css' %}">
{% endblock %}

{% block content %}
  <div class="auth-screen">
    <div class="auth-wrap">
      <div class="card">
        <div class="auth-topbar">
          <div class="auth-brand">PusikMusik</div>

          {% if request.user.is_authenticated %}
            <form method="post" action="{% url 'logout' %}" style="margin:0">
              {% csrf_token %}
              <button class="btn secondary" type="submit">Выйти</button>
            </form>
          {% endif %}
        </div>

        <div class="auth-tabs" role="tablist" aria-label="Вход и регистрация">
          <a class="auth-tab {% if active_tab == 'signup' %}is-active{% endif %}"
             href="{% url 'auth' %}?tab=signup{% if next %}&next={{ next|urlencode }}{% endif %}">
            Регистрация
          </a>
          <a class="auth-tab {% if active_tab == 'login' %}is-active{% endif %}"
             href="{% url 'auth' %}?tab=login{% if next %}&next={{ next|urlencode }}{% endif %}">
            Вход
          </a>
        </div>

        <!-- РЕГИСТРАЦИЯ -->
        <form method="post" class="auth-form {% if active_tab != 'signup' %}is-hidden{% endif %}">
          {% csrf_token %}
          <input type="hidden" name="action" value="signup">
          {% if next %}<input type="hidden" name="next" value="{{ next }}">{% endif %}

          {{ signup_form.non_field_errors }}

          {{ signup_form.username.label_tag }}
          {{ signup_form.username }}
          {{ signup_form.username.errors }}

          {{ signup_form.email.label_tag }}
          {{ signup_form.email }}
          {{ signup_form.email.errors }}

          {{ signup_form.password1.label_tag }}
          {{ signup_form.password1 }}
          {{ signup_form.password1.errors }}

          {{ signup_form.password2.label_tag }}
          {{ signup_form.password2 }}
          {{ signup_form.password2.errors }}

          <button class="btn primary" type="submit">Зарегистрироваться</button>

          <div class="auth-hint">
            Уже есть аккаунт?
            <a href="{% url 'auth' %}?tab=login{% if next %}&next={{ next|urlencode }}{% endif %}">Войти</a>
          </div>
        </form>

        <!-- ВХОД -->
        <form method="post" class="auth-form {% if active_tab != 'login' %}is-hidden{% endif %}">
          {% csrf_token %}
          <input type="hidden" name="action" value="login">
          {% if next %}<input type="hidden" name="next" value="{{ next }}">{% endif %}

          {{ login_form.non_field_errors }}

          {{ login_form.username.label_tag }}
          {{ login_form.username }}
          {{ login_form.username.errors }}

          {{ login_form.password.label_tag }}
          {{ login_form.password }}
          {{ login_form.password.errors }}

          <button class="btn primary" type="submit">Войти</button>

          <div class="auth-hint">
            Нет аккаунта?
            <a href="{% url 'auth' %}?tab=signup{% if next %}&next={{ next|urlencode }}{% endif %}">Создать</a>
          </div>
        </form>

      </div>
    </div>
  </div>
{% endblock %}
